{"paragraphs":[{"text":"import org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\nimport scala.io.Source\nimport scala.collection.mutable.HashMap\nimport java.io.File\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport sys.process.stringSeqToProcess","dateUpdated":"2017-01-26T18:45:34-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485474323602_-1764256993","id":"20170126-184523_492438434","dateCreated":"2017-01-26T18:45:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11212","dateFinished":"2017-01-26T18:45:39-0500","dateStarted":"2017-01-26T18:45:34-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.streaming._\n\nimport org.apache.spark.streaming.twitter._\n\nimport org.apache.spark.storage.StorageLevel\n\nimport scala.io.Source\n\nimport scala.collection.mutable.HashMap\n\nimport java.io.File\n\nimport org.apache.log4j.Logger\n\nimport org.apache.log4j.Level\n\nimport sys.process.stringSeqToProcess\n"}},{"text":"/** Configures the Oauth Credentials for accessing Twitter */\ndef configureTwitterCredentials(apiKey: String, apiSecret: String, accessToken: String, accessTokenSecret: String) {\n  val configs = new HashMap[String, String] ++= Seq(\n    \"apiKey\" -> apiKey, \"apiSecret\" -> apiSecret, \"accessToken\" -> accessToken, \"accessTokenSecret\" -> accessTokenSecret)\n  println(\"Configuring Twitter OAuth\")\n  configs.foreach{ case(key, value) =>\n    if (value.trim.isEmpty) {\n      throw new Exception(\"Error setting authentication - value for \" + key + \" not set\")\n    }\n    val fullKey = \"twitter4j.oauth.\" + key.replace(\"api\", \"consumer\")\n    System.setProperty(fullKey, value.trim)\n    println(\"\\tProperty \" + fullKey + \" set as [\" + value.trim + \"]\")\n  }\n  println()\n}","dateUpdated":"2017-01-26T18:45:44-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485472492521_-306248009","id":"20170126-181452_659345229","dateCreated":"2017-01-26T18:14:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10900","dateFinished":"2017-01-26T18:45:47-0500","dateStarted":"2017-01-26T18:45:44-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nconfigureTwitterCredentials: (apiKey: String, apiSecret: String, accessToken: String, accessTokenSecret: String)Unit\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485474292547_-1937625505","id":"20170126-184452_146439020","dateCreated":"2017-01-26T18:44:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11066","text":"// Configure Twitter credentials\nval apiKey = \"EbUV1Oej9fLhmncj19IGvlXSf\"\nval apiSecret = \"BbwOwLOgUyH3rPdIfE9WhCmu2wkbXqv2AukanQBD2pCtHob7M5\"\nval accessToken = \"702953416281231362-MF8RPsZ7zcd1M9GhmnwkgTsncGKbpiD\"\nval accessTokenSecret = \"W1aeYnbLrQa1a8xa9geXLPYDrsgMCQFL9Y7NsOUgk52il\"\nconfigureTwitterCredentials(apiKey, apiSecret, accessToken, accessTokenSecret)\n\nimport org.apache.spark.streaming.twitter._\nval ssc = new StreamingContext(sc, Seconds(2))\nval tweets = TwitterUtils.createStream(ssc, None)\nval twt = tweets.window(Seconds(60))\n\ncase class Tweet(createdAt:Long, text:String)\ntwt.map(status=>\n  Tweet(status.getCreatedAt().getTime()/1000, status.getText())\n).foreachRDD(rdd=>\n  // Below line works only in spark 1.3.0.\n  // For spark 1.1.x and spark 1.2.x,\n  // use rdd.registerTempTable(\"tweets\") instead.\n  rdd.toDF().registerTempTable(\"tweets\")\n \n)\n\ntwt.print\n\nssc.start()","dateUpdated":"2017-01-26T18:59:20-0500","dateFinished":"2017-01-26T18:59:28-0500","dateStarted":"2017-01-26T18:59:20-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\napiKey: String = EbUV1Oej9fLhmncj19IGvlXSf\n\napiSecret: String = BbwOwLOgUyH3rPdIfE9WhCmu2wkbXqv2AukanQBD2pCtHob7M5\n\naccessToken: String = 702953416281231362-MF8RPsZ7zcd1M9GhmnwkgTsncGKbpiD\n\naccessTokenSecret: String = W1aeYnbLrQa1a8xa9geXLPYDrsgMCQFL9Y7NsOUgk52il\nConfiguring Twitter OAuth\n\tProperty twitter4j.oauth.consumerKey set as [EbUV1Oej9fLhmncj19IGvlXSf]\n\tProperty twitter4j.oauth.accessToken set as [702953416281231362-MF8RPsZ7zcd1M9GhmnwkgTsncGKbpiD]\n\tProperty twitter4j.oauth.consumerSecret set as [BbwOwLOgUyH3rPdIfE9WhCmu2wkbXqv2AukanQBD2pCtHob7M5]\n\tProperty twitter4j.oauth.accessTokenSecret set as [W1aeYnbLrQa1a8xa9geXLPYDrsgMCQFL9Y7NsOUgk52il]\n\n\nimport org.apache.spark.streaming.twitter._\n\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@67147ce6\n\ntweets: org.apache.spark.streaming.dstream.ReceiverInputDStream[twitter4j.Status] = org.apache.spark.streaming.twitter.TwitterInputDStream@3e9469f5\n\ntwt: org.apache.spark.streaming.dstream.DStream[twitter4j.Status] = org.apache.spark.streaming.dstream.WindowedDStream@1c6ec20b\n\ndefined class Tweet\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"createdAt","index":0,"aggr":"sum"}],"values":[{"name":"text","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"createdAt","index":0,"aggr":"sum"},"yAxis":{"name":"text","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485474352469_1254159425","id":"20170126-184552_1681132221","dateCreated":"2017-01-26T18:45:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11306","dateUpdated":"2017-01-26T19:17:11-0500","dateFinished":"2017-01-26T19:17:12-0500","dateStarted":"2017-01-26T19:17:11-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"createdAt\ttext\n1485476169\tRT @OwenJones84: Unlike Donald Trump the majority of the British public are decent people and they should be repulsed by @theresa_may fawni…\n1485476189\tAbsolutely unbelievable... \"@GQMagazine: Donald Trump is discovering creative new ways to lie https://t.co/mCDIn4HhoS\"\n","comment":"","msgTable":[[{"key":"text","value":"1485476169"},{"key":"text","value":"RT @OwenJones84: Unlike Donald Trump the majority of the British public are decent people and they should be repulsed by @theresa_may fawni…"}],[{"value":"1485476189"},{"value":"Absolutely unbelievable... \"@GQMagazine: Donald Trump is discovering creative new ways to lie https://t.co/mCDIn4HhoS\""}]],"columnNames":[{"name":"createdAt","index":0,"aggr":"sum"},{"name":"text","index":1,"aggr":"sum"}],"rows":[["1485476169","RT @OwenJones84: Unlike Donald Trump the majority of the British public are decent people and they should be repulsed by @theresa_may fawni…"],["1485476189","Absolutely unbelievable... \"@GQMagazine: Donald Trump is discovering creative new ways to lie https://t.co/mCDIn4HhoS\""]]},"text":"%sql select * from tweets where text like '%Donald Trump%' limit 60"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475222245_429078827","id":"20170126-190022_1265618892","dateCreated":"2017-01-26T19:00:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11448","dateUpdated":"2017-01-26T19:17:19-0500","dateFinished":"2017-01-26T19:17:22-0500","dateStarted":"2017-01-26T19:17:19-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"createdAt\tcount(1)\n1485476170\t1\n1485476171\t40\n1485476172\t53\n1485476173\t39\n1485476174\t36\n1485476175\t44\n1485476176\t43\n1485476177\t42\n1485476178\t42\n1485476179\t26\n1485476180\t38\n1485476181\t43\n1485476182\t45\n1485476183\t45\n1485476184\t44\n1485476185\t30\n1485476186\t38\n1485476187\t55\n1485476188\t44\n1485476189\t43\n1485476190\t49\n1485476191\t28\n1485476192\t39\n1485476193\t37\n1485476194\t34\n1485476195\t38\n1485476196\t52\n1485476197\t29\n1485476198\t44\n1485476199\t39\n1485476200\t45\n1485476201\t38\n1485476202\t46\n1485476203\t30\n1485476204\t37\n1485476205\t30\n1485476206\t46\n1485476207\t44\n1485476208\t44\n1485476209\t46\n1485476210\t33\n1485476211\t38\n1485476212\t35\n1485476213\t38\n1485476214\t37\n1485476215\t39\n1485476216\t39\n1485476217\t36\n1485476218\t38\n1485476219\t32\n1485476220\t36\n1485476221\t53\n1485476222\t61\n1485476223\t48\n1485476224\t42\n1485476225\t49\n1485476226\t37\n1485476227\t50\n1485476228\t40\n1485476229\t51\n1485476230\t44\n","comment":"","msgTable":[[{"key":"count(1)","value":"1485476170"},{"key":"count(1)","value":"1"}],[{"value":"1485476171"},{"value":"40"}],[{"value":"1485476172"},{"value":"53"}],[{"value":"1485476173"},{"value":"39"}],[{"value":"1485476174"},{"value":"36"}],[{"value":"1485476175"},{"value":"44"}],[{"value":"1485476176"},{"value":"43"}],[{"value":"1485476177"},{"value":"42"}],[{"value":"1485476178"},{"value":"42"}],[{"value":"1485476179"},{"value":"26"}],[{"value":"1485476180"},{"value":"38"}],[{"value":"1485476181"},{"value":"43"}],[{"value":"1485476182"},{"value":"45"}],[{"value":"1485476183"},{"value":"45"}],[{"value":"1485476184"},{"value":"44"}],[{"value":"1485476185"},{"value":"30"}],[{"value":"1485476186"},{"value":"38"}],[{"value":"1485476187"},{"value":"55"}],[{"value":"1485476188"},{"value":"44"}],[{"value":"1485476189"},{"value":"43"}],[{"value":"1485476190"},{"value":"49"}],[{"value":"1485476191"},{"value":"28"}],[{"value":"1485476192"},{"value":"39"}],[{"value":"1485476193"},{"value":"37"}],[{"value":"1485476194"},{"value":"34"}],[{"value":"1485476195"},{"value":"38"}],[{"value":"1485476196"},{"value":"52"}],[{"value":"1485476197"},{"value":"29"}],[{"value":"1485476198"},{"value":"44"}],[{"value":"1485476199"},{"value":"39"}],[{"value":"1485476200"},{"value":"45"}],[{"value":"1485476201"},{"value":"38"}],[{"value":"1485476202"},{"value":"46"}],[{"value":"1485476203"},{"value":"30"}],[{"value":"1485476204"},{"value":"37"}],[{"value":"1485476205"},{"value":"30"}],[{"value":"1485476206"},{"value":"46"}],[{"value":"1485476207"},{"value":"44"}],[{"value":"1485476208"},{"value":"44"}],[{"value":"1485476209"},{"value":"46"}],[{"value":"1485476210"},{"value":"33"}],[{"value":"1485476211"},{"value":"38"}],[{"value":"1485476212"},{"value":"35"}],[{"value":"1485476213"},{"value":"38"}],[{"value":"1485476214"},{"value":"37"}],[{"value":"1485476215"},{"value":"39"}],[{"value":"1485476216"},{"value":"39"}],[{"value":"1485476217"},{"value":"36"}],[{"value":"1485476218"},{"value":"38"}],[{"value":"1485476219"},{"value":"32"}],[{"value":"1485476220"},{"value":"36"}],[{"value":"1485476221"},{"value":"53"}],[{"value":"1485476222"},{"value":"61"}],[{"value":"1485476223"},{"value":"48"}],[{"value":"1485476224"},{"value":"42"}],[{"value":"1485476225"},{"value":"49"}],[{"value":"1485476226"},{"value":"37"}],[{"value":"1485476227"},{"value":"50"}],[{"value":"1485476228"},{"value":"40"}],[{"value":"1485476229"},{"value":"51"}],[{"value":"1485476230"},{"value":"44"}]],"columnNames":[{"name":"createdAt","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["1485476170","1"],["1485476171","40"],["1485476172","53"],["1485476173","39"],["1485476174","36"],["1485476175","44"],["1485476176","43"],["1485476177","42"],["1485476178","42"],["1485476179","26"],["1485476180","38"],["1485476181","43"],["1485476182","45"],["1485476183","45"],["1485476184","44"],["1485476185","30"],["1485476186","38"],["1485476187","55"],["1485476188","44"],["1485476189","43"],["1485476190","49"],["1485476191","28"],["1485476192","39"],["1485476193","37"],["1485476194","34"],["1485476195","38"],["1485476196","52"],["1485476197","29"],["1485476198","44"],["1485476199","39"],["1485476200","45"],["1485476201","38"],["1485476202","46"],["1485476203","30"],["1485476204","37"],["1485476205","30"],["1485476206","46"],["1485476207","44"],["1485476208","44"],["1485476209","46"],["1485476210","33"],["1485476211","38"],["1485476212","35"],["1485476213","38"],["1485476214","37"],["1485476215","39"],["1485476216","39"],["1485476217","36"],["1485476218","38"],["1485476219","32"],["1485476220","36"],["1485476221","53"],["1485476222","61"],["1485476223","48"],["1485476224","42"],["1485476225","49"],["1485476226","37"],["1485476227","50"],["1485476228","40"],["1485476229","51"],["1485476230","44"]]},"text":"%sql select createdAt, count(1) from tweets group by createdAt order by createdAt"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475299964_538670967","id":"20170126-190139_501635213","dateCreated":"2017-01-26T19:01:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11549","dateUpdated":"2017-01-26T19:17:37-0500","dateFinished":"2017-01-26T19:17:38-0500","dateStarted":"2017-01-26T19:17:37-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nsentiment: (s: String)String\n"},"text":"def sentiment(s:String) : String = {\n    val positive = Array(\"like\", \"love\", \"good\", \"great\", \"happy\", \"cool\", \"the\", \"one\", \"that\")\n    val negative = Array(\"hate\", \"bad\", \"stupid\", \"is\")\n\n    var st = 0;\n\n    val words = s.split(\" \")    \n    positive.foreach(p =>\n        words.foreach(w =>\n            if(p==w) st = st+1\n        )\n    )\n\n    negative.foreach(p=>\n        words.foreach(w=>\n            if(p==w) st = st-1\n        )\n    )\n    if(st>0)\n        \"positivie\"\n    else if(st<0)\n        \"negative\"\n    else\n        \"neutral\"\n}"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475600527_1382054235","id":"20170126-190640_432492235","dateCreated":"2017-01-26T19:06:40-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11747","dateUpdated":"2017-01-26T19:07:05-0500","dateFinished":"2017-01-26T19:07:06-0500","dateStarted":"2017-01-26T19:07:05-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres21: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n"},"text":"// Below line works only in spark 1.3.0.\n// For spark 1.1.x and spark 1.2.x,\n// use sqlc.registerFunction(\"sentiment\", sentiment _) instead.\nsqlc.udf.register(\"sentiment\", sentiment _)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"UDF(text)","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"UDF(text)","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475625633_-798855772","id":"20170126-190705_1605320070","dateCreated":"2017-01-26T19:07:05-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11829","dateUpdated":"2017-01-26T19:18:19-0500","dateFinished":"2017-01-26T19:18:21-0500","dateStarted":"2017-01-26T19:18:19-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"UDF(text)\tcount(1)\nneutral\t5\n","comment":"","msgTable":[[{"key":"count(1)","value":"neutral"},{"key":"count(1)","value":"5"}]],"columnNames":[{"name":"UDF(text)","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["neutral","5"]]},"text":"%sql select sentiment(text), count(1) from tweets where text like '%Donald Trump%' group by sentiment(text)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475656671_-1220879343","id":"20170126-190736_846888775","dateCreated":"2017-01-26T19:07:36-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11911","dateUpdated":"2017-01-26T19:07:47-0500","text":""}],"name":"DS-670-HW2 Mohamed Mohamar","id":"2C781GR52","angularObjects":{"2C6FQ455K:shared_process":[],"2C9D492R1:shared_process":[],"2C9CEGXV9:shared_process":[],"2C6H727E3:shared_process":[],"2C7S9AJYU:shared_process":[],"2C7KGMJPQ:shared_process":[],"2C7AN1MQK:shared_process":[],"2C6CZU2ZF:shared_process":[],"2C8JZBUEM:shared_process":[],"2C8RVD7RF:shared_process":[],"2C6UNMUWP:shared_process":[],"2C7SFDFS9:shared_process":[],"2C7GKYMVZ:shared_process":[],"2C6M8N3TJ:shared_process":[],"2C8MVJ1XP:shared_process":[],"2C7DWJJ58:shared_process":[],"2C7P7UE63:shared_process":[],"2C7BA1B9V:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}